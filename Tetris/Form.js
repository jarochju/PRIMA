"use strict";
var Tetris;
(function (Tetris) {
    var ƒ = FudgeCore;
    class Form extends ƒ.Node {
        constructor() {
            super("Form");
            this.unit = 1.05;
            this.dirY = ƒ.Vector3.Y(-this.unit);
            this.color = ƒ.Color.CSS("WHITE");
            this.addComponent(new ƒ.ComponentTransform(ƒ.Matrix4x4.TRANSLATION(ƒ.Vector3.ZERO())));
        }
        moveY() {
            let transform = this.getComponent(ƒ.ComponentTransform);
            let matrix = transform.local.copy;
            matrix.translate(this.dirY);
            this.removeComponent(transform);
            this.addComponent(new ƒ.ComponentTransform(matrix));
        }
        moveX(dirX) {
            dirX.scale(this.unit);
            let transform = this.getComponent(ƒ.ComponentTransform);
            let matrix = transform.local.copy;
            matrix.translate(dirX);
            this.removeComponent(transform);
            this.addComponent(new ƒ.ComponentTransform(matrix));
        }
        createLN(pos = ƒ.Vector3.ZERO()) {
            this.color = ƒ.Color.CSS("CYAN");
            this.createLine(4, pos);
        }
        createLL(pos = ƒ.Vector3.ZERO()) {
            this.color = ƒ.Color.CSS("MAGENTA");
            this.createLine(3, pos);
            this.createQuad(new ƒ.Vector3(-this.unit + pos.x, this.unit + pos.y, 0 + pos.z));
        }
        createLR(pos = ƒ.Vector3.ZERO()) {
            this.color = ƒ.Color.CSS("YELLOW");
            this.createLine(3, pos);
            this.createQuad(new ƒ.Vector3(this.unit + pos.x, this.unit + pos.y, 0 + pos.z));
        }
        createZL(pos = ƒ.Vector3.ZERO()) {
            this.color = ƒ.Color.CSS("RED");
            this.createLine(2, new ƒ.Vector3(this.unit + pos.x, 0 + pos.y, 0 + pos.z));
            this.createLine(2, new ƒ.Vector3(0 + pos.x, 0 + this.unit + pos.y, 0 + pos.z));
        }
        createZR(pos = ƒ.Vector3.ZERO()) {
            this.color = ƒ.Color.CSS("GREEN");
            this.createLine(2, new ƒ.Vector3(0 + pos.x, 0 + pos.y, 0 + pos.z));
            this.createLine(2, new ƒ.Vector3(this.unit + pos.x, 0 + this.unit + pos.y, 0 + pos.z));
        }
        createSQ(pos = ƒ.Vector3.ZERO()) {
            this.color = ƒ.Color.CSS("BLUE");
            this.createLine(2, new ƒ.Vector3(0 + pos.x, 0 + pos.y, 0 + pos.z));
            this.createLine(2, new ƒ.Vector3(0 + pos.x, 0 + this.unit + pos.y, 0 + pos.z));
        }
        createTT(pos = ƒ.Vector3.ZERO()) {
            this.color = ƒ.Color.CSS("ORANGE");
            this.createLine(3, pos);
            this.createQuad(new ƒ.Vector3(0 + pos.x, 0 + this.unit + pos.y, 0 + pos.z));
        }
        createLine(len, pos = ƒ.Vector3.ZERO()) {
            while (len-- > 0)
                this.createQuad(new ƒ.Vector3(this.unit * len - this.unit + pos.x, 0 + pos.y, 0 + pos.z));
        }
        createQuad(pos) {
            let mesh = new ƒ.MeshQuad();
            let material = new ƒ.Material("Solid" + this.color.getCSS(), ƒ.ShaderUniColor, new ƒ.CoatColored(this.color));
            let segment = new ƒ.Node("Segment");
            let cmpMesh = new ƒ.ComponentMesh(mesh);
            segment.addComponent(cmpMesh);
            let cmpMaterial = new ƒ.ComponentMaterial(material);
            segment.addComponent(cmpMaterial);
            segment.addComponent(new ƒ.ComponentTransform(ƒ.Matrix4x4.TRANSLATION(pos)));
            this.appendChild(segment);
        }
    }
    Tetris.Form = Form;
})(Tetris || (Tetris = {}));
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiRm9ybS5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIkZvcm0udHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IjtBQUFBLElBQVUsTUFBTSxDQWdHZjtBQWhHRCxXQUFVLE1BQU07SUFDWixJQUFPLENBQUMsR0FBRyxTQUFTLENBQUM7SUFFckIsTUFBYSxJQUFLLFNBQVEsQ0FBQyxDQUFDLElBQUk7UUFNNUI7WUFDSSxLQUFLLENBQUMsTUFBTSxDQUFDLENBQUM7WUFOWCxTQUFJLEdBQVcsSUFBSSxDQUFDO1lBRW5CLFNBQUksR0FBYyxDQUFDLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQztZQUMxQyxVQUFLLEdBQVksQ0FBQyxDQUFDLEtBQUssQ0FBQyxHQUFHLENBQUMsT0FBTyxDQUFDLENBQUM7WUFJMUMsSUFBSSxDQUFDLFlBQVksQ0FBQyxJQUFJLENBQUMsQ0FBQyxrQkFBa0IsQ0FBQyxDQUFDLENBQUMsU0FBUyxDQUFDLFdBQVcsQ0FBQyxDQUFDLENBQUMsT0FBTyxDQUFDLElBQUksRUFBRSxDQUFDLENBQUMsQ0FBQyxDQUFDO1FBQzNGLENBQUM7UUFFTSxLQUFLO1lBQ1IsSUFBSSxTQUFTLEdBQXlCLElBQUksQ0FBQyxZQUFZLENBQUMsQ0FBQyxDQUFDLGtCQUFrQixDQUFDLENBQUM7WUFDOUUsSUFBSSxNQUFNLEdBQWdCLFNBQVMsQ0FBQyxLQUFLLENBQUMsSUFBSSxDQUFDO1lBQy9DLE1BQU0sQ0FBQyxTQUFTLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDO1lBQzVCLElBQUksQ0FBQyxlQUFlLENBQUMsU0FBUyxDQUFDLENBQUM7WUFDaEMsSUFBSSxDQUFDLFlBQVksQ0FBQyxJQUFJLENBQUMsQ0FBQyxrQkFBa0IsQ0FBQyxNQUFNLENBQUMsQ0FBQyxDQUFDO1FBQ3hELENBQUM7UUFFTSxLQUFLLENBQUMsSUFBZTtZQUN4QixJQUFJLENBQUMsS0FBSyxDQUFDLElBQUksQ0FBQyxJ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QUksT0FBTyxHQUFvQixJQUFJLENBQUMsQ0FBQyxhQUFhLENBQUMsSUFBSSxDQUFDLENBQUM7WUFDekQsT0FBTyxDQUFDLFlBQVksQ0FBQyxPQUFPLENBQUMsQ0FBQztZQUU5QixJQUFJLFdBQVcsR0FBd0IsSUFBSSxDQUFDLENBQUMsaUJBQWlCLENBQUMsUUFBUSxDQUFDLENBQUM7WUFDekUsT0FBTyxDQUFDLFlBQVksQ0FBQyxXQUFXLENBQUMsQ0FBQztZQUVsQyxPQUFPLENBQUMsWUFBWSxDQUFDLElBQUksQ0FBQyxDQUFDLGtCQUFrQixDQUFDLENBQUMsQ0FBQyxTQUFTLENBQUMsV0FBVyxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsQ0FBQztZQUU3RSxJQUFJLENBQUMsV0FBVyxDQUFDLE9BQU8sQ0FBQyxDQUFDO1FBQzlCLENBQUM7S0FFSjtJQTNGWSxXQUFJLE9BMkZoQixDQUFBO0FBRUwsQ0FBQyxFQWhHUyxNQUFNLEtBQU4sTUFBTSxRQWdHZiIsInNvdXJjZXNDb250ZW50IjpbIm5hbWVzcGFjZSBUZXRyaXMge1xyXG4gICAgaW1wb3J0IMaSID0gRnVkZ2VDb3JlO1xyXG5cclxuICAgIGV4cG9ydCBjbGFzcyBGb3JtIGV4dGVuZHMgxpIuTm9kZSB7XHJcbiAgICAgICAgcHVibGljIHVuaXQ6IG51bWJlciA9IDEuMDU7XHJcblxyXG4gICAgICAgIHByaXZhdGUgZGlyWTogxpIuVmVjdG9yMyA9IMaSLlZlY3RvcjMuWSgtdGhpcy51bml0KTtcclxuICAgICAgICBwcml2YXRlIGNvbG9yOiDGki5Db2xvciA9IMaSLkNvbG9yLkNTUyhcIldISVRFXCIpO1xyXG5cclxuICAgICAgICBjb25zdHJ1Y3RvcigpIHtcclxuICAgICAgICAgICAgc3VwZXIoXCJGb3JtXCIpO1xyXG4gICAgICAgICAgICB0aGlzLmFkZENvbXBvbmVudChuZXcgxpIuQ29tcG9uZW50VHJhbnNmb3JtKMaSLk1hdHJpeDR4NC5UUkFOU0xBVElPTijGki5WZWN0b3IzLlpFUk8oKSkpKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHB1YmxpYyBtb3ZlWSgpOiB2b2lkIHtcclxuICAgICAgICAgICAgbGV0IHRyYW5zZm9ybTogxpIuQ29tcG9uZW50VHJhbnNmb3JtID0gdGhpcy5nZXRDb21wb25lbnQoxpIuQ29tcG9uZW50VHJhbnNmb3JtKTtcclxuICAgICAgICAgICAgbGV0IG1hdHJpeDogxpIuTWF0cml4NHg0ID0gdHJhbnNmb3JtLmxvY2FsLmNvcHk7XHJcbiAgICAgICAgICAgIG1hdHJpeC50cmFuc2xhdGUodGhpcy5kaXJZKTtcclxuICAgICAgICAgICAgdGhpcy5yZW1vdmVDb21wb25lbnQodHJhbnNmb3JtKTtcclxuICAgICAgICAgICAgdGhpcy5hZGRDb21wb25lbnQobmV3IMaSLkNvbXBvbmVudFRyYW5zZm9ybShtYXRyaXgpKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHB1YmxpYyBtb3ZlWChkaXJYOiDGki5WZWN0b3IzKTogdm9pZCB7XHJcbiAgICAgICAgICAgIGRpclguc2NhbGUodGhpcy51bml0KTtcclxuICAgICAgICAgICAgbGV0IHRyYW5zZm9ybTogxpIuQ29tcG9uZW50VHJhbnNmb3JtID0gdGhpcy5nZXRDb21wb25lbnQoxpIuQ29tcG9uZW50VHJhbnNmb3JtKTtcclxuICAgICAgICAgICAgbGV0IG1hdHJpeDogxpIuTWF0cml4NHg0ID0gdHJhbnNmb3JtLmxvY2FsLmNvcHk7XHJcbiAgICAgICAgICAgIG1hdHJpeC50cmFuc2xhdGUoZGlyWCk7XHJcbiAgICAgICAgICAgIHRoaXMucmVtb3ZlQ29tcG9uZW50KHRyYW5zZm9ybSk7XHJcbiAgICAgICAgICAgIHRoaXMuYWRkQ29tcG9uZW50KG5ldyDGki5Db21wb25lbnRUcmFuc2Zvcm0obWF0cml4KSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwdWJsaWMgY3JlYXRlTE4ocG9zOiDGki5WZWN0b3IzID0gxpIuVmVjdG9yMy5aRVJPKCkpOiB2b2lkIHtcclxuICAgICAgICAgICAgdGhpcy5jb2xvciA9IMaSLkNvbG9yLkNTUyhcIkNZQU5cIik7XHJcbiAgICAgICAgICAgIHRoaXMuY3JlYXRlTGluZSg0LCBwb3MpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHVibGljIGNyZWF0ZUxMKHBvczogxpIuVmVjdG9yMyA9IMaSLlZlY3RvcjMuWkVSTygpKTogdm9pZCB7XHJcbiAgICAgICAgICAgIHRoaXMuY29sb3IgPSDGki5Db2xvci5DU1MoXCJNQUdFTlRBXCIpO1xyXG4gICAgICAgICAgICB0aGlzLmNyZWF0ZUxpbmUoMywgcG9zKTtcclxuICAgICAgICAgICAgdGhpcy5jcmVhdGVRdWFkKG5ldyDGki5WZWN0b3IzKC10aGlzLnVuaXQgKyBwb3MueCwgdGhpcy51bml0ICsgcG9zLnksIDAgKyBwb3MueikpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHVibGljIGNyZWF0ZUxSKHBvczogxpIuVmVjdG9yMyA9IMaSLlZlY3RvcjMuWkVSTygpKTogdm9pZCB7XHJcbiAgICAgICAgICAgIHRoaXMuY29sb3IgPSDGki5Db2xvci5DU1MoXCJZRUxMT1dcIik7XHJcbiAgICAgICAgICAgIHRoaXMuY3JlYXRlTGluZSgzLCBwb3MpO1xyXG4gICAgICAgICAgICB0aGlzLmNyZWF0ZVF1YWQobmV3IMaSLlZlY3RvcjModGhpcy51bml0ICsgcG9zLngsIHRoaXMudW5pdCArIHBvcy55LCAwICsgcG9zLnopKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHB1YmxpYyBjcmVhdGVaTChwb3M6IMaSLlZlY3RvcjMgPSDGki5WZWN0b3IzLlpFUk8oKSk6IHZvaWQge1xyXG4gICAgICAgICAgICB0aGlzLmNvbG9yID0gxpIuQ29sb3IuQ1NTKFwiUkVEXCIpO1xyXG4gICAgICAgICAgICB0aGlzLmNyZWF0ZUxpbmUoMiwgbmV3IMaSLlZlY3RvcjModGhpcy51bml0ICsgcG9zLngsIDAgKyBwb3MueSwgMCArIHBvcy56KSk7XHJcbiAgICAgICAgICAgIHRoaXMuY3JlYXRlTGluZSgyLCBuZXcgxpIuVmVjdG9yMygwICsgcG9zLngsIDAgKyB0aGlzLnVuaXQgKyBwb3MueSwgMCArIHBvcy56KSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwdWJsaWMgY3JlYXRlWlIocG9zOiDGki5WZWN0b3IzID0gxpIuVmVjdG9yMy5aRVJPKCkpOiB2b2lkIHtcclxuICAgICAgICAgICAgdGhpcy5jb2xvciA9IMaSLkNvbG9yLkNTUyhcIkdSRUVOXCIpO1xyXG4gICAgICAgICAgICB0aGlzLmNyZWF0ZUxpbmUoMiwgbmV3IMaSLlZlY3RvcjMoMCArIHBvcy54LCAwICsgcG9zLnksIDAgKyBwb3MueikpO1xyXG4gICAgICAgICAgICB0aGlzLmNyZWF0ZUxpbmUoMiwgbmV3IMaSLlZlY3RvcjModGhpcy51bml0ICsgcG9zLngsIDAgKyB0aGlzLnVuaXQgKyBwb3MueSwgMCArIHBvcy56KSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwdWJsaWMgY3JlYXRlU1EocG9zOiDGki5WZWN0b3IzID0gxpIuVmVjdG9yMy5aRVJPKCkpOiB2b2lkIHtcclxuICAgICAgICAgICAgdGhpcy5jb2xvciA9IMaSLkNvbG9yLkNTUyhcIkJMVUVcIik7XHJcbiAgICAgICAgICAgIHRoaXMuY3JlYXRlTGluZSgyLCBuZXcgxpIuVmVjdG9yMygwICsgcG9zLngsIDAgKyBwb3MueSwgMCArIHBvcy56KSk7XHJcbiAgICAgICAgICAgIHRoaXMuY3JlYXRlTGluZSgyLCBuZXcgxpIuVmVjdG9yMygwICsgcG9zLngsIDAgKyB0aGlzLnVuaXQgKyBwb3MueSwgMCArIHBvcy56KSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwdWJsaWMgY3JlYXRlVFQocG9zOiDGki5WZWN0b3IzID0gxpIuVmVjdG9yMy5aRVJPKCkpOiB2b2lkIHtcclxuICAgICAgICAgICAgdGhpcy5jb2xvciA9IMaSLkNvbG9yLkNTUyhcIk9SQU5HRVwiKTtcclxuICAgICAgICAgICAgdGhpcy5jcmVhdGVMaW5lKDMsIHBvcyk7XHJcbiAgICAgICAgICAgIHRoaXMuY3JlYXRlUXVhZChuZXcgxpIuVmVjdG9yMygwICsgcG9zLngsIDAgKyB0aGlzLnVuaXQgKyBwb3MueSwgMCArIHBvcy56KSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwcml2YXRlIGNyZWF0ZUxpbmUobGVuOiBudW1iZXIsIHBvczogxpIuVmVjdG9yMyA9IMaSLlZlY3RvcjMuWkVSTygpKTogdm9pZCB7XHJcbiAgICAgICAgICAgIHdoaWxlIChsZW4tLSA+IDApXHJcbiAgICAgICAgICAgICAgICB0aGlzLmNyZWF0ZVF1YWQobmV3IMaSLlZlY3RvcjModGhpcy51bml0ICogbGVuIC0gdGhpcy51bml0ICsgcG9zLngsIDAgKyBwb3MueSwgMCArIHBvcy56KSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwcml2YXRlIGNyZWF0ZVF1YWQocG9zOiDGki5WZWN0b3IzKTogdm9pZCB7XHJcbiAgICAgICAgICAgIGxldCBtZXNoOiDGki5NZXNoUXVhZCA9IG5ldyDGki5NZXNoUXVhZCgpO1xyXG4gICAgICAgICAgICBsZXQgbWF0ZXJpYWw6IMaSLk1hdGVyaWFsID0gbmV3IMaSLk1hdGVyaWFsKFwiU29saWRcIiArIHRoaXMuY29sb3IuZ2V0Q1NTKCksIMaSLlNoYWRlclVuaUNvbG9yLCBuZXcgxpIuQ29hdENvbG9yZWQodGhpcy5jb2xvcikpO1xyXG5cclxuICAgICAgICAgICAgbGV0IHNlZ21lbnQ6IMaSLk5vZGUgPSBuZXcgxpIuTm9kZShcIlNlZ21lbnRcIik7XHJcblxyXG4gICAgICAgICAgICBsZXQgY21wTWVzaDogxpIuQ29tcG9uZW50TWVzaCA9IG5ldyDGki5Db21wb25lbnRNZXNoKG1lc2gpO1xyXG4gICAgICAgICAgICBzZWdtZW50LmFkZENvbXBvbmVudChjbXBNZXNoKTtcclxuXHJcbiAgICAgICAgICAgIGxldCBjbXBNYXRlcmlhbDogxpIuQ29tcG9uZW50TWF0ZXJpYWwgPSBuZXcgxpIuQ29tcG9uZW50TWF0ZXJpYWwobWF0ZXJpYWwpO1xyXG4gICAgICAgICAgICBzZWdtZW50LmFkZENvbXBvbmVudChjbXBNYXRlcmlhbCk7XHJcblxyXG4gICAgICAgICAgICBzZWdtZW50LmFkZENvbXBvbmVudChuZXcgxpIuQ29tcG9uZW50VHJhbnNmb3JtKMaSLk1hdHJpeDR4NC5UUkFOU0xBVElPTihwb3MpKSk7XHJcblxyXG4gICAgICAgICAgICB0aGlzLmFwcGVuZENoaWxkKHNlZ21lbnQpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICB9XHJcblxyXG59Il19