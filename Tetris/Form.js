"use strict";
var Tetris;
(function (Tetris) {
    var ƒ = FudgeCore;
    class Form extends ƒ.Node {
        constructor() {
            super("Form");
            this.unit = 1.05;
            this.dirY = ƒ.Vector3.Y(-this.unit);
            //private dirX: ƒ.Vector3 = ƒ.Vector3.X();
            this.color = ƒ.Color.CSS("WHITE");
            this.addComponent(new ƒ.ComponentTransform(ƒ.Matrix4x4.TRANSLATION(ƒ.Vector3.ZERO())));
        }
        move() {
            let transform = this.getComponent(ƒ.ComponentTransform);
            let matrix = transform.local.copy;
            matrix.translate(this.dirY);
            this.removeComponent(transform);
            this.addComponent(new ƒ.ComponentTransform(matrix));
        }
        createLN(pos = ƒ.Vector3.ZERO()) {
            this.color = ƒ.Color.CSS("CYAN");
            this.createLine(4, pos);
        }
        createLL(pos = ƒ.Vector3.ZERO()) {
            this.color = ƒ.Color.CSS("MAGENTA");
            this.createLine(3, pos);
            this.createQuad(new ƒ.Vector3(-this.unit + pos.x, this.unit + pos.y, 0 + pos.z));
        }
        createLR(pos = ƒ.Vector3.ZERO()) {
            this.color = ƒ.Color.CSS("YELLOW");
            this.createLine(3, pos);
            this.createQuad(new ƒ.Vector3(this.unit + pos.x, this.unit + pos.y, 0 + pos.z));
        }
        createZL(pos = ƒ.Vector3.ZERO()) {
            this.color = ƒ.Color.CSS("RED");
            this.createLine(2, new ƒ.Vector3(this.unit + pos.x, 0 + pos.y, 0 + pos.z));
            this.createLine(2, new ƒ.Vector3(0 + pos.x, 0 + this.unit + pos.y, 0 + pos.z));
        }
        createZR(pos = ƒ.Vector3.ZERO()) {
            this.color = ƒ.Color.CSS("GREEN");
            this.createLine(2, new ƒ.Vector3(0 + pos.x, 0 + pos.y, 0 + pos.z));
            this.createLine(2, new ƒ.Vector3(this.unit + pos.x, 0 + this.unit + pos.y, 0 + pos.z));
        }
        createSQ(pos = ƒ.Vector3.ZERO()) {
            this.color = ƒ.Color.CSS("BLUE");
            this.createLine(2, new ƒ.Vector3(0 + pos.x, 0 + pos.y, 0 + pos.z));
            this.createLine(2, new ƒ.Vector3(0 + pos.x, 0 + this.unit + pos.y, 0 + pos.z));
        }
        createTT(pos = ƒ.Vector3.ZERO()) {
            this.color = ƒ.Color.CSS("ORANGE");
            this.createLine(3, pos);
            this.createQuad(new ƒ.Vector3(0 + pos.x, 0 + this.unit + pos.y, 0 + pos.z));
        }
        createLine(len, pos = ƒ.Vector3.ZERO()) {
            while (len-- > 0)
                this.createQuad(new ƒ.Vector3(this.unit * len - this.unit + pos.x, 0 + pos.y, 0 + pos.z));
        }
        createQuad(pos) {
            let mesh = new ƒ.MeshQuad();
            let material = new ƒ.Material("Solid" + this.color.getCSS(), ƒ.ShaderUniColor, new ƒ.CoatColored(this.color));
            let segment = new ƒ.Node("Segment");
            let cmpMesh = new ƒ.ComponentMesh(mesh);
            segment.addComponent(cmpMesh);
            let cmpMaterial = new ƒ.ComponentMaterial(material);
            segment.addComponent(cmpMaterial);
            segment.addComponent(new ƒ.ComponentTransform(ƒ.Matrix4x4.TRANSLATION(pos)));
            this.appendChild(segment);
        }
    }
    Tetris.Form = Form;
})(Tetris || (Tetris = {}));
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiRm9ybS5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIkZvcm0udHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IjtBQUFBLElBQVUsTUFBTSxDQXlGZjtBQXpGRCxXQUFVLE1BQU07SUFDWixJQUFPLENBQUMsR0FBRyxTQUFTLENBQUM7SUFFckIsTUFBYSxJQUFLLFNBQVEsQ0FBQyxDQUFDLElBQUk7UUFPNUI7WUFDSSxLQUFLLENBQUMsTUFBTSxDQUFDLENBQUM7WUFQWCxTQUFJLEdBQVcsSUFBSSxDQUFDO1lBRW5CLFNBQUksR0FBYyxDQUFDLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQztZQUNsRCwwQ0FBMEM7WUFDbEMsVUFBSyxHQUFZLENBQUMsQ0FBQyxLQUFLLENBQUMsR0FBRyxDQUFDLE9BQU8sQ0FBQyxDQUFDO1lBSTFDLElBQUksQ0FBQyxZQUFZLENBQUMsSUFBSSxDQUFDLENBQUMsa0JBQWtCLENBQUMsQ0FBQyxDQUFDLFNBQVMsQ0FBQyxXQUFXLENBQUMsQ0FBQyxDQUFDLE9BQU8sQ0FBQyxJQUFJLEVBQUUsQ0FBQyxDQUFDLENBQUMsQ0FBQztRQUMzRixDQUFDO1FBRU0sSUFBSTtZQUNQLElBQUksU0FBUyxHQUF5QixJQUFJLENBQUMsWUFBWSxDQUFDLENBQUMsQ0FBQyxrQkFBa0IsQ0FBQyxDQUFDO1lBQzlFLElBQUksTUFBTSxHQUFnQixTQUFTLENBQUMsS0FBSyxDQUFDLElBQUksQ0FBQztZQUMvQyxNQUFNLENBQUMsU0FBUyxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQztZQUM1QixJQUFJLENBQUMsZUFBZSxDQUFDLFNBQVMsQ0FBQyxDQUFDO1lBQ2hDLElBQUksQ0FBQyxZQUFZLENBQUMsSUFBSSxDQUFDLENBQUMsa0JBQWtCLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBQztRQUV4RCxDQUFDO1FBRU0sUUFBUSxDQUFDLE1BQWlCLENBQUMsQ0FBQyxPQUFPLENBQUMsSUFB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QUFDO1FBQzlCLENBQUM7S0FFSjtJQXBGWSxXQUFJLE9Bb0ZoQixDQUFBO0FBRUwsQ0FBQyxFQXpGUyxNQUFNLEtBQU4sTUFBTSxRQXlGZiIsInNvdXJjZXNDb250ZW50IjpbIm5hbWVzcGFjZSBUZXRyaXMge1xyXG4gICAgaW1wb3J0IMaSID0gRnVkZ2VDb3JlO1xyXG5cclxuICAgIGV4cG9ydCBjbGFzcyBGb3JtIGV4dGVuZHMgxpIuTm9kZSB7XHJcbiAgICAgICAgcHVibGljIHVuaXQ6IG51bWJlciA9IDEuMDU7XHJcblxyXG4gICAgICAgIHByaXZhdGUgZGlyWTogxpIuVmVjdG9yMyA9IMaSLlZlY3RvcjMuWSgtdGhpcy51bml0KTtcclxuICAgICAgICAvL3ByaXZhdGUgZGlyWDogxpIuVmVjdG9yMyA9IMaSLlZlY3RvcjMuWCgpO1xyXG4gICAgICAgIHByaXZhdGUgY29sb3I6IMaSLkNvbG9yID0gxpIuQ29sb3IuQ1NTKFwiV0hJVEVcIik7XHJcblxyXG4gICAgICAgIGNvbnN0cnVjdG9yKCkge1xyXG4gICAgICAgICAgICBzdXBlcihcIkZvcm1cIik7XHJcbiAgICAgICAgICAgIHRoaXMuYWRkQ29tcG9uZW50KG5ldyDGki5Db21wb25lbnRUcmFuc2Zvcm0oxpIuTWF0cml4NHg0LlRSQU5TTEFUSU9OKMaSLlZlY3RvcjMuWkVSTygpKSkpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHVibGljIG1vdmUoKTogdm9pZCB7XHJcbiAgICAgICAgICAgIGxldCB0cmFuc2Zvcm06IMaSLkNvbXBvbmVudFRyYW5zZm9ybSA9IHRoaXMuZ2V0Q29tcG9uZW50KMaSLkNvbXBvbmVudFRyYW5zZm9ybSk7XHJcbiAgICAgICAgICAgIGxldCBtYXRyaXg6IMaSLk1hdHJpeDR4NCA9IHRyYW5zZm9ybS5sb2NhbC5jb3B5O1xyXG4gICAgICAgICAgICBtYXRyaXgudHJhbnNsYXRlKHRoaXMuZGlyWSk7XHJcbiAgICAgICAgICAgIHRoaXMucmVtb3ZlQ29tcG9uZW50KHRyYW5zZm9ybSk7XHJcbiAgICAgICAgICAgIHRoaXMuYWRkQ29tcG9uZW50KG5ldyDGki5Db21wb25lbnRUcmFuc2Zvcm0obWF0cml4KSk7XHJcblxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHVibGljIGNyZWF0ZUxOKHBvczogxpIuVmVjdG9yMyA9IMaSLlZlY3RvcjMuWkVSTygpKTogdm9pZCB7XHJcbiAgICAgICAgICAgIHRoaXMuY29sb3IgPSDGki5Db2xvci5DU1MoXCJDWUFOXCIpO1xyXG4gICAgICAgICAgICB0aGlzLmNyZWF0ZUxpbmUoNCwgcG9zKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHB1YmxpYyBjcmVhdGVMTChwb3M6IMaSLlZlY3RvcjMgPSDGki5WZWN0b3IzLlpFUk8oKSk6IHZvaWQge1xyXG4gICAgICAgICAgICB0aGlzLmNvbG9yID0gxpIuQ29sb3IuQ1NTKFwiTUFHRU5UQVwiKTtcclxuICAgICAgICAgICAgdGhpcy5jcmVhdGVMaW5lKDMsIHBvcyk7XHJcbiAgICAgICAgICAgIHRoaXMuY3JlYXRlUXVhZChuZXcgxpIuVmVjdG9yMygtdGhpcy51bml0ICsgcG9zLngsIHRoaXMudW5pdCArIHBvcy55LCAwICsgcG9zLnopKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHB1YmxpYyBjcmVhdGVMUihwb3M6IMaSLlZlY3RvcjMgPSDGki5WZWN0b3IzLlpFUk8oKSk6IHZvaWQge1xyXG4gICAgICAgICAgICB0aGlzLmNvbG9yID0gxpIuQ29sb3IuQ1NTKFwiWUVMTE9XXCIpO1xyXG4gICAgICAgICAgICB0aGlzLmNyZWF0ZUxpbmUoMywgcG9zKTtcclxuICAgICAgICAgICAgdGhpcy5jcmVhdGVRdWFkKG5ldyDGki5WZWN0b3IzKHRoaXMudW5pdCArIHBvcy54LCB0aGlzLnVuaXQgKyBwb3MueSwgMCArIHBvcy56KSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwdWJsaWMgY3JlYXRlWkwocG9zOiDGki5WZWN0b3IzID0gxpIuVmVjdG9yMy5aRVJPKCkpOiB2b2lkIHtcclxuICAgICAgICAgICAgdGhpcy5jb2xvciA9IMaSLkNvbG9yLkNTUyhcIlJFRFwiKTtcclxuICAgICAgICAgICAgdGhpcy5jcmVhdGVMaW5lKDIsIG5ldyDGki5WZWN0b3IzKHRoaXMudW5pdCArIHBvcy54LCAwICsgcG9zLnksIDAgKyBwb3MueikpO1xyXG4gICAgICAgICAgICB0aGlzLmNyZWF0ZUxpbmUoMiwgbmV3IMaSLlZlY3RvcjMoMCArIHBvcy54LCAwICsgdGhpcy51bml0ICsgcG9zLnksIDAgKyBwb3MueikpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHVibGljIGNyZWF0ZVpSKHBvczogxpIuVmVjdG9yMyA9IMaSLlZlY3RvcjMuWkVSTygpKTogdm9pZCB7XHJcbiAgICAgICAgICAgIHRoaXMuY29sb3IgPSDGki5Db2xvci5DU1MoXCJHUkVFTlwiKTtcclxuICAgICAgICAgICAgdGhpcy5jcmVhdGVMaW5lKDIsIG5ldyDGki5WZWN0b3IzKDAgKyBwb3MueCwgMCArIHBvcy55LCAwICsgcG9zLnopKTtcclxuICAgICAgICAgICAgdGhpcy5jcmVhdGVMaW5lKDIsIG5ldyDGki5WZWN0b3IzKHRoaXMudW5pdCArIHBvcy54LCAwICsgdGhpcy51bml0ICsgcG9zLnksIDAgKyBwb3MueikpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHVibGljIGNyZWF0ZVNRKHBvczogxpIuVmVjdG9yMyA9IMaSLlZlY3RvcjMuWkVSTygpKTogdm9pZCB7XHJcbiAgICAgICAgICAgIHRoaXMuY29sb3IgPSDGki5Db2xvci5DU1MoXCJCTFVFXCIpO1xyXG4gICAgICAgICAgICB0aGlzLmNyZWF0ZUxpbmUoMiwgbmV3IMaSLlZlY3RvcjMoMCArIHBvcy54LCAwICsgcG9zLnksIDAgKyBwb3MueikpO1xyXG4gICAgICAgICAgICB0aGlzLmNyZWF0ZUxpbmUoMiwgbmV3IMaSLlZlY3RvcjMoMCArIHBvcy54LCAwICsgdGhpcy51bml0ICsgcG9zLnksIDAgKyBwb3MueikpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHVibGljIGNyZWF0ZVRUKHBvczogxpIuVmVjdG9yMyA9IMaSLlZlY3RvcjMuWkVSTygpKTogdm9pZCB7XHJcbiAgICAgICAgICAgIHRoaXMuY29sb3IgPSDGki5Db2xvci5DU1MoXCJPUkFOR0VcIik7XHJcbiAgICAgICAgICAgIHRoaXMuY3JlYXRlTGluZSgzLCBwb3MpO1xyXG4gICAgICAgICAgICB0aGlzLmNyZWF0ZVF1YWQobmV3IMaSLlZlY3RvcjMoMCArIHBvcy54LCAwICsgdGhpcy51bml0ICsgcG9zLnksIDAgKyBwb3MueikpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHJpdmF0ZSBjcmVhdGVMaW5lKGxlbjogbnVtYmVyLCBwb3M6IMaSLlZlY3RvcjMgPSDGki5WZWN0b3IzLlpFUk8oKSk6IHZvaWQge1xyXG4gICAgICAgICAgICB3aGlsZSAobGVuLS0gPiAwKVxyXG4gICAgICAgICAgICAgICAgdGhpcy5jcmVhdGVRdWFkKG5ldyDGki5WZWN0b3IzKHRoaXMudW5pdCAqIGxlbiAtIHRoaXMudW5pdCArIHBvcy54LCAwICsgcG9zLnksIDAgKyBwb3MueikpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHJpdmF0ZSBjcmVhdGVRdWFkKHBvczogxpIuVmVjdG9yMyk6IHZvaWQge1xyXG4gICAgICAgICAgICBsZXQgbWVzaDogxpIuTWVzaFF1YWQgPSBuZXcgxpIuTWVzaFF1YWQoKTtcclxuICAgICAgICAgICAgbGV0IG1hdGVyaWFsOiDGki5NYXRlcmlhbCA9IG5ldyDGki5NYXRlcmlhbChcIlNvbGlkXCIgKyB0aGlzLmNvbG9yLmdldENTUygpLCDGki5TaGFkZXJVbmlDb2xvciwgbmV3IMaSLkNvYXRDb2xvcmVkKHRoaXMuY29sb3IpKTtcclxuXHJcbiAgICAgICAgICAgIGxldCBzZWdtZW50OiDGki5Ob2RlID0gbmV3IMaSLk5vZGUoXCJTZWdtZW50XCIpO1xyXG5cclxuICAgICAgICAgICAgbGV0IGNtcE1lc2g6IMaSLkNvbXBvbmVudE1lc2ggPSBuZXcgxpIuQ29tcG9uZW50TWVzaChtZXNoKTtcclxuICAgICAgICAgICAgc2VnbWVudC5hZGRDb21wb25lbnQoY21wTWVzaCk7XHJcblxyXG4gICAgICAgICAgICBsZXQgY21wTWF0ZXJpYWw6IMaSLkNvbXBvbmVudE1hdGVyaWFsID0gbmV3IMaSLkNvbXBvbmVudE1hdGVyaWFsKG1hdGVyaWFsKTtcclxuICAgICAgICAgICAgc2VnbWVudC5hZGRDb21wb25lbnQoY21wTWF0ZXJpYWwpO1xyXG5cclxuICAgICAgICAgICAgc2VnbWVudC5hZGRDb21wb25lbnQobmV3IMaSLkNvbXBvbmVudFRyYW5zZm9ybSjGki5NYXRyaXg0eDQuVFJBTlNMQVRJT04ocG9zKSkpO1xyXG5cclxuICAgICAgICAgICAgdGhpcy5hcHBlbmRDaGlsZChzZWdtZW50KTtcclxuICAgICAgICB9XHJcblxyXG4gICAgfVxyXG5cclxufSJdfQ==