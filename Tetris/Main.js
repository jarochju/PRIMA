"use strict";
var Tetris;
(function (Tetris) {
    var ƒ = FudgeCore;
    window.addEventListener("load", hndLoad);
    let form;
    function hndLoad(_event) {
        const canvas = document.querySelector("canvas");
        form = new Tetris.Form();
        let r = Math.random();
        let p = 1 / 7;
        let rx = Math.floor(Math.random() * 14) - 7;
        let y = 10;
        let pos = new ƒ.Vector3(rx * form.unit, y * form.unit, 0);
        if (r > p * 6)
            form.createLN(pos);
        else if (r > p * 5)
            form.createLL(pos);
        else if (r > p * 4)
            form.createLR(pos);
        else if (r > p * 3)
            form.createZL(pos);
        else if (r > p * 2)
            form.createZR(pos);
        else if (r > p * 1)
            form.createSQ(pos);
        else if (r > p * 0)
            form.createTT(pos);
        let cmpCamera = new ƒ.ComponentCamera();
        cmpCamera.pivot.translateZ(25);
        cmpCamera.pivot.rotateY(180);
        Tetris.viewport = new ƒ.Viewport();
        Tetris.viewport.initialize("Viewport", form, cmpCamera, canvas);
        document.addEventListener("keydown", control);
        ƒ.Loop.addEventListener("loopFrame" /* LOOP_FRAME */, update);
        ƒ.Loop.start(ƒ.LOOP_MODE.TIME_REAL, 1);
    }
    function update(_event) {
        Tetris.viewport.draw();
        form.move();
    }
    function control(_event) {
        let direction;
        direction = ƒ.Keyboard.mapToValue(ƒ.Vector3.Y(), ƒ.Vector3.ZERO(), [ƒ.KEYBOARD_CODE.W, ƒ.KEYBOARD_CODE.ARROW_UP]);
        direction.add(ƒ.Keyboard.mapToValue(ƒ.Vector3.Y(-1), ƒ.Vector3.ZERO(), [ƒ.KEYBOARD_CODE.S, ƒ.KEYBOARD_CODE.ARROW_DOWN]));
        if (direction.y == 0) {
            direction = ƒ.Keyboard.mapToValue(ƒ.Vector3.X(), ƒ.Vector3.ZERO(), [ƒ.KEYBOARD_CODE.D, ƒ.KEYBOARD_CODE.ARROW_RIGHT]);
            direction.add(ƒ.Keyboard.mapToValue(ƒ.Vector3.X(-1), ƒ.Vector3.ZERO(), [ƒ.KEYBOARD_CODE.A, ƒ.KEYBOARD_CODE.ARROW_LEFT]));
        }
        /*if (!direction.equals(ƒ.Vector3.ZERO()))
          form.direction = direction;*/
    }
})(Tetris || (Tetris = {}));
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiTWFpbi5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIk1haW4udHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IjtBQUFBLElBQVUsTUFBTSxDQStEZjtBQS9ERCxXQUFVLE1BQU07SUFDZCxJQUFPLENBQUMsR0FBRyxTQUFTLENBQUM7SUFFckIsTUFBTSxDQUFDLGdCQUFnQixDQUFDLE1BQU0sRUFBRSxPQUFPLENBQUMsQ0FBQztJQUV6QyxJQUFJLElBQVUsQ0FBQztJQUVmLFNBQVMsT0FBTyxDQUFDLE1BQWE7UUFDNUIsTUFBTSxNQUFNLEdBQXNCLFFBQVEsQ0FBQyxhQUFhLENBQUMsUUFBUSxDQUFDLENBQUM7UUFFbkUsSUFBSSxHQUFHLElBQUksT0FBQSxJQUFJLEVBQUUsQ0FBQztRQUNsQixJQUFJLENBQUMsR0FBVyxJQUFJLENBQUMsTUFBTSxFQUFFLENBQUM7UUFDOUIsSUFBSSxDQUFDLEdBQVcsQ0FBQyxHQUFHLENBQUMsQ0FBQztRQUN0QixJQUFJLEVBQUUsR0FBVyxJQUFJLENBQUMsS0FBSyxDQUFDLElBQUksQ0FBQyxNQUFNLEVBQUUsR0FBRyxFQUFFLENBQUMsR0FBRyxDQUFDLENBQUM7UUFDcEQsSUFBSSxDQUFDLEdBQVcsRUFBRSxDQUFDO1FBQ25CLElBQUksR0FBRyxHQUFjLElBQUksQ0FBQyxDQUFDLE9BQU8sQ0FBQyxFQUFFLEdBQUcsSUFBSSxDQUFDLElBQUksRUFBRSxDQUFDLEdBQUcsSUFBSSxDQUFDLElBQUksRUFBRSxDQUFDLENBQUMsQ0FBQztRQUNyRSxJQUFJLENBQUMsR0FBRyxDQUFDLEdBQUcsQ0FBQztZQUNYLElBQUksQ0FBQyxRQUFRLENBQUMsR0FBRyxDQUFDLENBQUM7YUFDaEIsSUFBSSxDQUFDLEdBQUcsQ0FBQyxHQUFHLENBQUM7WUFDaEIsSUFBSSxDQUFDLFFBQVEsQ0FBQyxHQUFHLENBQUMsQ0FBQzthQUNoQixJQUFJLENBQUMsR0FBRyxDQUFDLEdBQUcsQ0FBQztZQUNoQixJQUFJLENBQUMsUUFBUSxDQUFD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Q0FBQyxDQUFDLENBQUMsQ0FBQztTQUMxSDtRQUVEO3VDQUMrQjtJQUNqQyxDQUFDO0FBQ0gsQ0FBQyxFQS9EUyxNQUFNLEtBQU4sTUFBTSxRQStEZiIsInNvdXJjZXNDb250ZW50IjpbIm5hbWVzcGFjZSBUZXRyaXMge1xyXG4gIGltcG9ydCDGkiA9IEZ1ZGdlQ29yZTtcclxuXHJcbiAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoXCJsb2FkXCIsIGhuZExvYWQpO1xyXG4gIGV4cG9ydCBsZXQgdmlld3BvcnQ6IMaSLlZpZXdwb3J0O1xyXG4gIGxldCBmb3JtOiBGb3JtO1xyXG5cclxuICBmdW5jdGlvbiBobmRMb2FkKF9ldmVudDogRXZlbnQpOiB2b2lkIHtcclxuICAgIGNvbnN0IGNhbnZhczogSFRNTENhbnZhc0VsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiY2FudmFzXCIpO1xyXG5cclxuICAgIGZvcm0gPSBuZXcgRm9ybSgpO1xyXG4gICAgbGV0IHI6IG51bWJlciA9IE1hdGgucmFuZG9tKCk7XHJcbiAgICBsZXQgcDogbnVtYmVyID0gMSAvIDc7XHJcbiAgICBsZXQgcng6IG51bWJlciA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDE0KSAtIDc7XHJcbiAgICBsZXQgeTogbnVtYmVyID0gMTA7XHJcbiAgICBsZXQgcG9zOiDGki5WZWN0b3IzID0gbmV3IMaSLlZlY3RvcjMocnggKiBmb3JtLnVuaXQsIHkgKiBmb3JtLnVuaXQsIDApO1xyXG4gICAgaWYgKHIgPiBwICogNilcclxuICAgICAgZm9ybS5jcmVhdGVMTihwb3MpO1xyXG4gICAgZWxzZSBpZiAociA+IHAgKiA1KVxyXG4gICAgICBmb3JtLmNyZWF0ZUxMKHBvcyk7XHJcbiAgICBlbHNlIGlmIChyID4gcCAqIDQpXHJcbiAgICAgIGZvcm0uY3JlYXRlTFIocG9zKTtcclxuICAgIGVsc2UgaWYgKHIgPiBwICogMylcclxuICAgICAgZm9ybS5jcmVhdGVaTChwb3MpO1xyXG4gICAgZWxzZSBpZiAociA+IHAgKiAyKVxyXG4gICAgICBmb3JtLmNyZWF0ZVpSKHBvcyk7XHJcbiAgICBlbHNlIGlmIChyID4gcCAqIDEpXHJcbiAgICAgIGZvcm0uY3JlYXRlU1EocG9zKTtcclxuICAgIGVsc2UgaWYgKHIgPiBwICogMClcclxuICAgICAgZm9ybS5jcmVhdGVUVChwb3MpO1xyXG5cclxuICAgIGxldCBjbXBDYW1lcmE6IMaSLkNvbXBvbmVudENhbWVyYSA9IG5ldyDGki5Db21wb25lbnRDYW1lcmEoKTtcclxuICAgIGNtcENhbWVyYS5waXZvdC50cmFuc2xhdGVaKDI1KTtcclxuICAgIGNtcENhbWVyYS5waXZvdC5yb3RhdGVZKDE4MCk7XHJcblxyXG4gICAgdmlld3BvcnQgPSBuZXcgxpIuVmlld3BvcnQoKTtcclxuICAgIHZpZXdwb3J0LmluaXRpYWxpemUoXCJWaWV3cG9ydFwiLCBmb3JtLCBjbXBDYW1lcmEsIGNhbnZhcyk7XHJcblxyXG4gICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgY29udHJvbCk7XHJcblxyXG4gICAgxpIuTG9vcC5hZGRFdmVudExpc3RlbmVyKMaSLkVWRU5ULkxPT1BfRlJBTUUsIHVwZGF0ZSk7XHJcbiAgICDGki5Mb29wLnN0YXJ0KMaSLkxPT1BfTU9ERS5USU1FX1JFQUwsIDEpO1xyXG4gIH1cclxuXHJcbiAgZnVuY3Rpb24gdXBkYXRlKF9ldmVudDogxpIuRXZlbnTGkik6IHZvaWQge1xyXG4gICAgdmlld3BvcnQuZHJhdygpO1xyXG5cclxuICAgIGZvcm0ubW92ZSgpO1xyXG4gIH1cclxuXHJcbiAgZnVuY3Rpb24gY29udHJvbChfZXZlbnQ6IEV2ZW50KTogdm9pZCB7XHJcbiAgICBsZXQgZGlyZWN0aW9uOiDGki5WZWN0b3IzO1xyXG4gICAgZGlyZWN0aW9uID0gxpIuS2V5Ym9hcmQubWFwVG9WYWx1ZSjGki5WZWN0b3IzLlkoKSwgxpIuVmVjdG9yMy5aRVJPKCksIFvGki5LRVlCT0FSRF9DT0RFLlcsIMaSLktFWUJPQVJEX0NPREUuQVJST1dfVVBdKTtcclxuICAgIGRpcmVjdGlvbi5hZGQoxpIuS2V5Ym9hcmQubWFwVG9WYWx1ZSjGki5WZWN0b3IzLlkoLTEpLCDGki5WZWN0b3IzLlpFUk8oKSwgW8aSLktFWUJPQVJEX0NPREUuUywgxpIuS0VZQk9BUkRfQ09ERS5BUlJPV19ET1dOXSkpO1xyXG5cclxuICAgIGlmIChkaXJlY3Rpb24ueSA9PSAwKSB7XHJcbiAgICAgIGRpcmVjdGlvbiA9IMaSLktleWJvYXJkLm1hcFRvVmFsdWUoxpIuVmVjdG9yMy5YKCksIMaSLlZlY3RvcjMuWkVSTygpLCBbxpIuS0VZQk9BUkRfQ09ERS5ELCDGki5LRVlCT0FSRF9DT0RFLkFSUk9XX1JJR0hUXSk7XHJcbiAgICAgIGRpcmVjdGlvbi5hZGQoxpIuS2V5Ym9hcmQubWFwVG9WYWx1ZSjGki5WZWN0b3IzLlgoLTEpLCDGki5WZWN0b3IzLlpFUk8oKSwgW8aSLktFWUJPQVJEX0NPREUuQSwgxpIuS0VZQk9BUkRfQ09ERS5BUlJPV19MRUZUXSkpO1xyXG4gICAgfVxyXG5cclxuICAgIC8qaWYgKCFkaXJlY3Rpb24uZXF1YWxzKMaSLlZlY3RvcjMuWkVSTygpKSlcclxuICAgICAgZm9ybS5kaXJlY3Rpb24gPSBkaXJlY3Rpb247Ki9cclxuICB9XHJcbn0iXX0=